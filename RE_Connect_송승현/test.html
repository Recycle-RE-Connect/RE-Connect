<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
  </head>
  <body>
    <div class="info-tel">
      <select class="phone-first" name="user_phone" required>
        <option value="">연락처</option>
        <option value="010" selected="">010</option>
        <option value="011">011</option>
        <option value="016">016</option>
        <option value="017">017</option>
        <option value="018">018</option>
        <option value="019">019</option>
      </select>
      <input
        class="phone-last"
        type="text"
        name="user_phone"
        required
        maxlength="8"
        oninput="formatPhoneNumber(this)"
      />
      <input
        type="button"
        value="인증번호 받기"
        class="phone-check"
        id="sendVerificationButton"
        onclick="sendVerificationCode()"
        disabled
      />
    </div>

    <div class="verification-code" style="display: none">
      <input
        type="text"
        name="verification_code"
        id="verificationCode"
        placeholder="인증번호 입력"
        required
        oninput="checkVerificationCode()"
      />
      <input
        type="button"
        value="인증번호 확인"
        class="verify-button"
        id="verifyButton"
        onclick="verifyCode()"
        disabled
      />
    </div>

    <script>
      function formatPhoneNumber(inputElement) {
        // 입력 필드에서 숫자만 추출
        let inputValue = inputElement.value.replace(/[^0-9]/g, "");

        // 8자리 숫자인 경우 뒤에 "-" 추가
        if (inputValue.length === 8) {
          inputValue =
            inputValue.substring(0, 4) + "-" + inputValue.substring(4);
        }

        // 입력 필드에 형식을 적용한 값을 설정
        inputElement.value = inputValue;

        // 입력 필드에서 공백을 제거하여 길이를 확인
        const inputText = inputValue.replace(/\s/g, ""); // 공백 제거
        const isValid = inputText.length === 9; // 하이픈 포함 길이

        // "인증번호 받기" 버튼 활성화/비활성화 설정
        const sendVerificationButton = document.getElementById(
          "sendVerificationButton"
        );
        sendVerificationButton.disabled = !isValid;
      }

      function sendVerificationCode() {
        // 여기에 인증번호를 전송하는 로직을 추가하세요.
        // 예를 들어, AJAX 요청을 사용하여 서버에 요청을 보내고
        // 서버에서 인증번호를 생성하고 전송할 수 있습니다.

        // 아래는 간단한 예시입니다.
        alert("인증번호를 전송했습니다."); // 실제로는 이 부분을 서버와 통신하여 대체해야 합니다.

        // "인증번호 입력" 필드와 "인증번호 확인" 버튼을 표시하고 활성화
        const verificationCodeDiv =
          document.querySelector(".verification-code");
        verificationCodeDiv.style.display = "block";

        const verificationCodeInput =
          document.getElementById("verificationCode");
        const verifyButton = document.getElementById("verifyButton");
        verificationCodeInput.removeAttribute("disabled");
        verifyButton.removeAttribute("disabled");
      }

      function checkVerificationCode() {
        const verificationCodeInput =
          document.getElementById("verificationCode");
        const verifyButton = document.getElementById("verifyButton");

        // 입력 필드에서 공백을 제거하여 길이를 확인
        const inputText = verificationCodeInput.value.replace(/\s/g, ""); // 공백 제거

        // 입력값이 없거나 인증번호 길이가 6자리인 경우에만 "인증번호 확인" 버튼 활성화
        const isValid = inputText.length === 0 || inputText.length === 6;

        // "인증번호 확인" 버튼 활성화/비활성화 설정
        verifyButton.disabled = !isValid;
      }

      function verifyCode() {
        // 여기에서 사용자가 입력한 인증번호를 확인하는 로직을 추가하세요.
        // 인증이 성공하면 적절한 조치를 취하십시오.

        // 아래는 간단한 예시입니다.
        alert("인증번호가 확인되었습니다."); // 실제로는 이 부분을 인증 로직에 대체해야 합니다.
      }
    </script>
  </body>
</html>
